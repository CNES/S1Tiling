.. _files:

.. index:: files

======================================================================
Files produced
======================================================================

.. contents:: Contents:
   :local:
   :depth: 3

.. _final-products:

Final products
--------------

.. _full-S2-tiles:
.. index:: S2 tiles

Orthorectified S2 tiles
+++++++++++++++++++++++++++++

:Content: Complete final product: concatenated orthorectified S1 images on S2
          grid

:Directory:  :ref:`%(output) <paths.output>`:samp:`/{{tilename}}/` by default

:Directory format: :samp:`{{out_dir}}/{{tile_name}}`, see
                   :ref:`[Processing].dname_fmt.tiled
                   <Processing.dname_fmt.tiled>`

:File name:

    - :samp:`s1{{a|b}}_{{tilename}}_{{polarity}}_{{orbitdirection}}_{{orbitnumber}}_{{YYYYMMDD}}txxxxxx.tif` when the tile has been assembled from the concatenation of two S1 images
    - :samp:`s1{{a|b}}_{{tilename}}_{{polarity}}_{{orbitdirection}}_{{orbitnumber}}_{{YYYYMMDD}}t{{hhmmss}}.tif` when the tile has been produced from a single S1 image

    .. note::
        :math:`σ^0_{RTC}` calibrated files will have their name end in
        :file:`_NormLim.tif`

:File name format:

    - :samp:`{{flying_unit_code}}_{{tile_name}}_{{polarisation}}_{{orbit_direction}}_{{orbit}}_{{acquisition_stamp}}.tif`, see :ref:`[Processing].fname_fmt.concatenation <Processing.fname_fmt.concatenation>`
    - or,  :samp:`{{flying_unit_code}}_{{tile_name}}_{{polarisation}}_{{orbit_direction}}_{{orbit}}_{{acquisition_stamp}}_NormLim.tif`, see :ref:`[Processing].fname_fmt.lia_corrected <Processing.fname_fmt.lia_corrected>`

:Product encoding:

    - defaults to Float32 GeoTIFF, deflate compressed
    - defined in :ref:`[Processing].creation_options.tiled
      <processing.creation_options.tiled>`

:Metadata: The following metadata is added to the origin S1 images

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``ACQUISITION_DATETIME``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``ACQUISITION_DATETIME_1``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``ACQUISITION_DATETIME_2``
        - time of the second S1 image (in UTC format since v1.1)
      * - ``CALIBRATION``
        - :ref:`chosen calibration option <Processing.calibration>`
      * - ``FLYING_UNIT_CODE``
        - :samp:`s1{{a|b}}`
      * - ``IMAGE_TYPE``
        - :samp:`GRD`
      * - ``INPUT_S1_IMAGES``
        - List of the input Sentinel-1 images used to generate this product
      * - ``LIA_FILE``
        - (when applies) name of the LIA file used for Normlim calibration
      * - ``NOISE_REMOVED``
        - :ref:`chosen noise removal option <Processing.remove_thermal_noise>`
      * - ``ORBIT_NUMBER``
        - :samp:`{{orbitNumber}}`
      * - ``ORBIT_DIRECTION``
        - :samp:`{{orbitDirection}}`
      * - ``ORTHORECTIFIED``
        - :samp:`true`
      * - ``POLARIZATION``
        - :samp:`{{polarisation}}`
      * - ``RELATIVE_ORBIT_NUMBER``
        - :samp:`{{relativeOrbitNumber}}`
      * - ``S2_TILE_CORRESPONDING_CODE``
        - :samp:`{{tilename}}`
      * - ``SPATIAL_RESOLUTION``
        - :ref:`chosen output spatial resolution option <Processing.output_spatial_resolution>`
      * - ``TIFFTAG_DATETIME``
        - is updated with the time when the tile has been generated by S1 Tiling.
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`{{calibration}} calibrated orthorectified Sentinel-1{{A|B}} IW GRD on S2 tile`
      * - ``TIFFTAG_SOFTWARE``
        - :samp:`S1 Tiling v{{version}}` -- |version| currently

.. _mask-files:
.. index:: Mask files

Mask files
++++++++++

:Content: Binary image containing mask on valide data. It is a mask on no-data pixels.

:Directory:  :ref:`%(output) <paths.output>`:samp:`/{{tilename}}/` by default

:Directory format: :samp:`{{out_dir}}/{{tile_name}}`, see
                   :ref:`[Processing].dname_fmt.mask
                   <Processing.dname_fmt.mask>`

:File name: the same as the one from :ref:`the S2 tiles <full-S2-tiles>`, with
            `_BorderMask` appended

:Product encoding:

    - defaults to Byte GeoTIFF, deflate compressed
    - defined in :ref:`[Processing].creation_options.mask
      <processing.creation_options.mask>`


:Metadata: This file contains the same metadata as the one from :ref:`the S2 tile product <full-S2-tiles>` it has been generated from, with the following as the only difference:

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`Orthorectified Sentinel-1A IW GRD smoothed border mask S2 tile`


.. _filtered-files:
.. index:: Filtered files

Filtered files
++++++++++++++

:Content: Complete final product, after applying the speckle filtering if option is activated

:Directory:  :ref:`%(output) <paths.output>`:samp:`/filtered/{{tilename}}/` by
             default

:Directory format: :samp:`{{out_dir}}/filtered/{{tile_name}}`, see
                   :ref:`[Processing].dname_fmt.filtered
                   <Processing.dname_fmt.filtered>`

:File name: the same as the one from :ref:`the S2 tiles <full-S2-tiles>`, with
            `_filtered` appended

:File name format:

    - :samp:`{{flying_unit_code}}_{{tile_name}}_{{polarisation}}_{{orbit_direction}}_{{orbit}}_{{acquisition_stamp}}_filtered.tif`, see :ref:`[Processing].fname_fmt.filtered <Processing.fname_fmt.filtered>`
    - or,  :samp:`{{flying_unit_code}}_{{tile_name}}_{{polarisation}}_{{orbit_direction}}_{{orbit}}_{{acquisition_stamp}}_NormLim_filtered.tif`

:Product encoding:

    - defaults to Float32 GeoTIFF, deflate compressed
    - defined in :ref:`[Processing].creation_options.filtered
      <processing.creation_options.filtered>`


:Metadata: This file contains the same metadata as the one from :ref:`the S2 tile product <full-S2-tiles>` it has been generated from, with the following as the only difference:

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``FILTERED``
        - :samp:`true`

      * - ``FILTERING_METHOD``
        - The method used:
          :samp:`Lee`/:samp:`Frost`/:samp:`gammamap`/:samp:`Kuan`

      * - ``FILTERING_WINDOW_RADIUS``
        - The window radius used.

      * - ``FILTERING_DERAMP``
        - The deramp factor used (only for Frost method)

      * - ``FILTERING_NBLOOKS``
        - The number of looks used (only for Lee, Gammamap and Kuan methods)


.. _lia-files:
.. index:: Local Incidence Angle map files

Local Incidence Angle map files
+++++++++++++++++++++++++++++++

:Content:

    - Map of sines of Local Incidence Angle (LIA),
    - and optionally of LIA expressed in degree and scaled by a factor of 100.

    Given T, the target point on Earth's surface, and S the SAR sensor
    position, the LIA is the angle Θ\ :sub:`LIM` between the ground normal
    projected in range plane :math:`\overrightarrow{n}` (plane defined by S,
    T, and Earth's center) and :math:`\overrightarrow{TS}`.

    The values have been orthorectified on the Sentinel-2 tile from a pair of
    :ref:`LIA maps computed on S1 images <lia-s1-files>`.

:Directory:  :ref:`%(output_lia)/ <paths.lia>` by default

:Directory format: :samp:`{{lia_dir}}`, see
                   :ref:`[Processing].dname_fmt.lia_product
                   <Processing.dname_fmt.lia_product>`

:File names:

    - :samp:`sin_LIA_s1{{a|b}}_{{tilename}}_{{orbitdirection}}_{{orbitnumber}}.tif` -- :math:`sin(Θ_{LIM})`
    - :samp:`LIA_s1{{a|b}}_{{tilename}}_{{orbitdirection}}_{{orbitnumber}}.tif` -- :math:`100 * Θ°_{LIM}`

:File name format:

    :samp:`{{LIA_kind}}_{{flying_unit_code}}_{{tile_name}}_{{orbit_direction}}_{{orbit}}.tif`, see :ref:`[Processing].fname_fmt.lia_product <Processing.fname_fmt.lia_product>`

:Product encoding:

    - defaults to Float32 (/Uint16) GeoTIFF, deflate compressed
    - defined in :ref:`[Processing].creation_options.lia_sin
      <processing.creation_options.lia_sin>`
      (/:ref:`[Processing].creation_options.lia_deg
      <processing.creation_options.lia_deg>`)


:Metadata: The following metadata is added to the origin S1 images

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``ACQUISITION_DATETIME``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``ACQUISITION_DATETIME_1``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``ACQUISITION_DATETIME_2``
        - time of the second S1 image (in UTC format since v1.1)
      * - ``DATA_TYPE``
        - :samp:`100 * degree(LIA)` / :samp:`SIN(LIA)`
      * - ``FLYING_UNIT_CODE``
        - :samp:`s1{{a|b}}`
      * - ``IMAGE_TYPE``
        - :samp:`GRD`
      * - ``INPUT_S1_IMAGES``
        - List of the input Sentinel-1 images used to generate this product
      * - ``ORBIT``
        - :samp:`{{orbitnumber}}`
      * - ``ORBIT_DIRECTION``
        - :samp:`{{orbitdirection}}`
      * - ``ORTHORECTIFIED``
        - :samp:`true`
      * - ``S2_TILE_CORRESPONDING_CODE``
        - :samp:`{{tilename}}`
      * - ``SPATIAL_RESOLUTION``
        - :ref:`chosen output spatial resolution option <Processing.output_spatial_resolution>`
      * - ``TIFFTAG_DATETIME``
        - is updated with the time when the tile has been generated by S1 Tiling.
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`Orthorectified LIA/sin_LIA Sentinel-1A IW GRD`
      * - ``TIFFTAG_SOFTWARE``
        - :samp:`S1 Tiling v{{version}}` -- |version| currently


.. _temporary-files:

.. index:: Temporary files

Temporary files
---------------

Before generating the final products, S1 Tiling produces temporary files. Some
are removed automatically, others are :ref:`cached <data-caches>` in between
several runs to shorten processing times when resuming after an interruption.

.. note:: It's up to you, end-user, to clean that directory regularly.

.. _orthoready-files:

Cut and calibrated S1 images ready for orthorectification
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
:Content: S1 images :ref:`calibrated <calibration-proc>` and :ref:`cut <cutting-proc>`.

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S1/`

:File name: The same as the origin S1 file with ``_OrthoReady`` appended.

      .. note::
            An accompanying OTB ``.geom`` file was also generated with OTB 7.

      Example:

      .. code-block:: none

           s1a-iw-grd-vv-20200108t044150-20200108t044215-030704-038506-001_sigma_OrthoReady.tiff
           s1a-iw-grd-vv-20200108t044150-20200108t044215-030704-038506-001_sigma_OrthoReady.geom

:File name format:

    ``fname_fmt.cut_borders`` = :samp:`{{rootname}}_{{calibration_type}}_OrthoReady.tiff`

:Product encoding: Float32 GeoTIFF, uncompressed.

:Metadata: The following metadata are added at this step:

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value
      * - ``ACQUISITION_DATETIME``
        - time of the input S1 image (in UTC format since v1.1)
      * - ``CALIBRATION``
        - :ref:`chosen calibration option <Processing.calibration>`
      * - ``FLYING_UNIT_CODE``
        - :samp:`s1{{a|b}}`
      * - ``IMAGE_TYPE``
        - :samp:`GRD`
      * - ``INPUT_S1_IMAGES``
        - Name of the input Sentinel-1 image used to generate this product
      * - ``NOISE_REMOVED``
        - :ref:`chosen noise removal option <Processing.remove_thermal_noise>`
      * - ``ORBIT``
        - :samp:`{{orbitnumber}}`
      * - ``ORBIT_DIRECTION``
        - :samp:`{{orbitdirection}}`
      * - ``POLARIZATION``
        - :samp:`{{polarisation}}`
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`{{calibration}} calibrated Sentinel-1{{A|B}} IW GRD`

.. note::
   These files can be kept as a same calibrated and cut S1 image can be
   orthorectified for producing several intersecting S2 tiles.

.. note::
   These temporary files will be produced only if :program:`S1Processor` is
   executed with ``--cache-before-ortho`` option.  In that case, the processing
   will no longer be done in memory and orthoready files will be produced.
   You would also have to explicitly clean these temporary files.

.. _orthorectified-files:

Orthorectified S1 images
++++++++++++++++++++++++

:Content: Single concatenated orthorectified S1 image on S2 grid

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S2/{{tilename}}/`

:File name: :samp:`s1{{a|b}}_{{tilename}}_{{polarity}}_{{orbitdirection}}_{{orbitnumber}}_{{YYYYMMDD}}t{{hhmmss}}_{{calibration}}.tif`

:File name format:

    ``fname_fmt.orthorectification`` = :samp:`{{flying_unit_code}}_{{tile_name}}_{{polarisation}}_{{orbit_direction}}_{{orbit}}_{{acquisition_time}}_{{calibration_type}}.tif`

:Product encoding: Float32 GeoTIFF, deflate compressed

:Metadata: The metadata listed for :ref:`the S2 tile product <full-S2-tiles>`
           are actually produced at this step.

.. note::
   These files are automatically cleaned up.

.. _dem-vrt-files:

DEM VRT files
+++++++++++++

:Content: Virtual aggregate of all the DEM files that fully cover the
          associated input S1 images (in both polarities).

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S1/`

:File name:

    - :samp:`DEM-s1{tilename}.tif`
    - or deprecated: :samp:`DEM-s1{{a|b}}-iw-grd-{{start_stamp}}-{{end_stamp}}-{{nr1}}-{{nr2}}.tif`

:File name format:

    - ``fname_fmt.dem_s2_agglomeration`` = :samp:`DEM_{{tile_name}}.vrt`
    - or deprecated: ``fname_fmt.dem_s1_agglomeration`` = :samp:`DEM_{{polarless_rootname}}.vrt`

:Product encoding: VRT

:Metadata: No metadata is added by S1Tiling to these files.

:Cleanup: These files are cleaned automatically (since new workflow from v1.1).


.. _DEM_on_S2-files:

DEM data projected on S2 tile
+++++++++++++++++++++++++++++

:Content:          DEM information projected on S2 tile according to
                   :ref:`project_dem_to_s2-proc`
:Directory:        :ref:`%(tmp) <paths.tmp>`:samp:`/S2/`
:File name:        :samp:`DEM_projected_on_{{tilename}}.tiff`
:File name format: ``fname_fmt.dem_on_s2`` = :samp:`DEM_projected_on_{{tile_name}}.tiff`
:Product encoding: Float32 GeoTIFF, uncompressed.
:Metadata:         The following metadata are added at this step:

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value
      * - ``S2_TILE_CORRESPONDING_CODE``
        - :samp:`{{tilename}}`
      * - ``SPATIAL_RESOLUTION``
        - :ref:`chosen output spatial resolution option <Processing.output_spatial_resolution>`
      * - ``DEM_LIST``
        - List of DEM (SRTM currently) tiles used to generate the file
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`Warped DEM to S2 tile`

:Cleanup: These files are cleaned automatically.

.. _height_on_S2-files:

Height (DEM+Geoid) projected on S2 tile
+++++++++++++++++++++++++++++++++++++++

:Content:          Height information (DEM + Geoid combined) projected on S2
                   tile according to :ref:`project_geoid_to_s2-proc` and
                   :ref:`Sum DEM + Geoid <sum_dem_geoid_on_s2-proc>`.
:Directory:        :ref:`%(tmp) <paths.tmp>`:samp:`/S2/`
:File name:        :samp:`DEM+GEOID_projected_on_{{tilename}}.tiff`
:File name format: ``fname_fmt.height_on_s2`` = :samp:`DEM+GEOID_projected_on_{{tile_name}}.tiff`
:Product encoding: Float32 GeoTIFF, uncompressed.
:Metadata:         The following metadata changed from the :ref:`DEM projected on S2 tile <DEM_on_S2-files>`

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`DEM + GEOID height info projected on S2 tile`

:Cleanup:

    .. warning::
       These files still **need** to be cleaned manually. This should change
       eventually, or it may be conditionned to an option.


.. _ground_and_sat_S2-files:

Ground and sensor position in XYZ ECEF coordinates
++++++++++++++++++++++++++++++++++++++++++++++++++

:Content:          Six bands 64 bits float image that contains ground pixel
                   coordinates and associated sensor position coordinates
                   expressed as XYZ cartesian pixels in `ECEF
                   <https://en.wikipedia.org/wiki/Earth-centered,_Earth-fixed_coordinate_system>`_
                   spatial reference.
                   The image footprint matches the associated S2 tile.
:Directory:        :ref:`%(tmp) <paths.tmp>`:samp:`/S2/`
:File name:        :samp:`XYZ_projected_on_{{tile_name}}_{{orbitdirection}}_{{orbitnumber}}.tif`
:File name format: ``fname_fmt.ground_and_sat_s2`` = :samp:`XYZ_projected_on_{{tile_name}}_{{orbit_direction}}_{{orbit}}.tif`
:Product encoding: Float64 GeoTIFF, 6 bands: XCartesian, YCartesian,
                   ZCartesian. SensorXCartesian, SensorXCartesian,
                   SensorZCartesian
:Metadata:         The following metadata changed from the :ref:`DEM+GEOID projected on S2 tile <height_on_S2-files>`

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``ACQUISITION_DATETIME``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``DEM_LIST``
        - List of DEM (SRTM currently) tiles used to generate the file
      * - ``FLYING_UNIT_CODE``
        - :samp:`s1{{a|b}}`
      * - ``IMAGE_TYPE``
        - :samp:`GRD`
      * - ``INPUT_S1_IMAGES``
        - List of the input Sentinel-1 images used to generate this product
      * - ``ORBIT``
        - :samp:`{{orbitnumber}}`
      * - ``ORBIT_DIRECTION``
        - :samp:`{{orbitdirection}}`
      * - ``PRJ.DIRECTIONTOSCANDEMC``
        - Range direction for DEM scan.
      * - ``PRJ.DIRECTIONTOSCANDEML``
        - Azimuth direction for DEM scan.
      * - ``PRJ.GAIN``
        - Gain value
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`XYZ ground and satellite positions on S2 tile`

:Cleanup: These files are cleaned automatically.


Deprecated temporary files
--------------------------

.. _S1_on_dem-files:

Files of S1 coordinates projected on DEM geometry (deprecated)
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

:Content: Pixels are in the :ref:`Virtual DEM <dem-vrt-files>` geometry. Their
          values contain the XYZ cartesian coordinates of the pixel and the
          position of the matching pixel in the original Sentinel-1 image.
          This file is produced with `DiapOTB SARDEMProjection
          <https://gitlab.orfeo-toolbox.org/remote_modules/diapotb/-/wikis/Applications/app_SARDEMProjection>`_
          application.

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S1/`

:File name: :samp:`S1_on_DEM-s1{{a|b}}-iw-grd-{{start_stamp}}-{{end_stamp}}-{{nr1}}-{{nr2}}.tif`

:File name format:

    ``fname_fmt.s1_on_dem`` = :samp:`S1_on_DEM_{{polarless_basename}}`

:Product encoding: Float32 GeoTIFF, 7 bands: C (colunm into SAR image), L (line
                   into SAR image), Z and Y, XCartesian, YCartesian,
                   ZCartesian.

:Metadata: The following metadata is added to the origin S1 images

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``ACQUISITION_DATETIME``
        - time of the first S1 image (in UTC format since v1.1)
      * - ``DEM_LIST``
        - List of DEM (SRTM currently) tiles used to generate the file
      * - ``FLYING_UNIT_CODE``
        - :samp:`s1{{a|b}}`
      * - ``IMAGE_TYPE``
        - :samp:`GRD`
      * - ``INPUT_S1_IMAGES``
        - List of the input Sentinel-1 images used to generate this product
      * - ``ORBIT``
        - :samp:`{{orbitnumber}}`
      * - ``ORBIT_DIRECTION``
        - :samp:`{{orbitdirection}}`
      * - ``PRJ.DIRECTIONTOSCANDEMC``
        - Range direction for DEM scan.
      * - ``PRJ.DIRECTIONTOSCANDEML``
        - Azimuth direction for DEM scan.
      * - ``PRJ.GAIN``
        - Gain value
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`SARDEM projection onto DEM list`

:Cleanup:

    .. warning::
       These files still **need** to be cleaned manually. This should change
       eventually, or it may be conditionned to an option.

.. _xyz-files:

Files of XYZ cartesian coordinates in S1 geometry (deprecated)
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

:Content: Pixels are in the original Sentinel-1 image geometry. Their
          values contain the XYZ cartesian coordinates of the pixel.
          This file is produced with `our patched version
          <https://gitlab.orfeo-toolbox.org/s1-tiling/normlim_sigma0/-/merge_requests/1>`_
          of `DiapOTB SARCartesianMeanEstimation
          <https://gitlab.orfeo-toolbox.org/remote_modules/diapotb/-/wikis/Applications/app_SARCartesianMeanEstimation>`_
          application.

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S1/`

:File name: :samp:`XYZ-s1{{a|b}}-iw-grd-{{start_stamp}}-{{end_stamp}}-{{nr1}}-{{nr2}}.tif`

:File name format:

    ``fname_fmt.xyz`` = :samp:`XYZ_{{polarless_basename}}`

:Product encoding: Float32 GeoTIFF, 4 bands: XCartesian, YCartesian, ZCartesian, and ???

:Metadata: The following metadata changed from the :ref:`SARDEMProjected images <S1_on_dem-files>`

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``PRJ.DIRECTIONTOSCANDEMC``
        - **Removed**
      * - ``PRJ.DIRECTIONTOSCANDEML``
        - **Removed**
      * - ``PRJ.GAIN``
        - **Removed**
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`Cartesian XYZ coordinates estimation`

:Cleanup:

    .. warning::
       These files still **need** to be cleaned manually. This should change
       eventually, or it may be conditionned to an option.

.. _lia-s1-files:

Local Incidence Angle map files in S1 geometry (deprecated)
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

:Content:

    - Map of sines of Local Incidence Angle (LIA),
    - and optionally of LIA expressed in degree and scaled by a factor of 100.

    Given T, the target point on Earth's surface, and S the SAR sensor
    position, the LIA is the angle Θ\ :sub:`LIM` between the ground normal
    projected in range plane :math:`\overrightarrow{n}` (plane defined by S,
    T, and Earth's center) and :math:`\overrightarrow{TS}`.

    Unlike the :ref:`final LIA maps in S2 geometry <lia-files>`, the LIA map is
    in the geometry of the original Sentinel-1 image used to produce it.

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S1/`

:File name:

    - :samp:`LIA-s1{{a|b}}-iw-grd-{{start_stamp}}-{{end_stamp}}-{{nr1}}-{{nr2}}.tif`
    - :samp:`sin-LIA-s1{{a|b}}-iw-grd-{{start_stamp}}-{{end_stamp}}-{{nr1}}-{{nr2}}.tif`

:File name format:

    - ``fname_fmt.s1_lia`` = :samp:`LIA_{{polarless_basename}}`
    - ``fname_fmt.s1_sin_lia`` = :samp:`sin_LIA_{{polarless_basename}}`

:Product encoding: Float32 GeoTIFF

:Metadata: The following metadata is changed the :ref:`XYZ estimated coordinates <xyz-files>`

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`LIA on Sentinel-1A IW GRD`

:Cleanup:

    .. warning::
       These files still **need** to be cleaned manually. This should change
       eventually, or it may be conditionned to an option.

.. _lia-s2-half-files:

Half Local Incidence Angle map files -- pre-concatenation. (deprecated)
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

:Content:

    - Map of sines of Local Incidence Angle (LIA),
    - and optionally of LIA expressed in degree and scaled by a factor of 100.

    These files directly match the :ref:`LIA maps computed on S1 images
    <lia-s1-files>`, after orthorectification to the Sentinel-2 tile, and
    before their concatenation in the :ref:`final LIA maps in S2 geometry
    <lia-files>`.

:Directory:  :ref:`%(tmp) <paths.tmp>`:samp:`/S2/`

:File names:

    - :samp:`sin_LIA_s1{{a|b}}_{{tilename}}_{{orbitdirection}}_{{orbitnumber}}_{{start_stamp}}.tif` -- :math:`sin(Θ_{LIM})`
    - :samp:`LIA_s1{{a|b}}_{{tilename}}_{{orbitdirection}}_{{orbitnumber}}_{{start_stamp}}.tif` -- :math:`100 * Θ°_{LIM}`

:File name format:

    ``fname_fmt.lia_orthorectification`` = :samp:`{{LIA_kind}}_{{flying_unit_code}}_{{tile_name}}_{{orbit_direction}}_{{orbit}}_{{acquisition_time}}.tif`

:Product encoding: Float32 (and Int16) GeoTIFF, deflate compressed

:Metadata: The following metadata is changed from the :ref:`un-orthorectified LIA maps <lia-s1-files>`

    .. list-table::
      :widths: auto
      :header-rows: 1
      :stub-columns: 1

      * - Metadata
        - Value

      * - ``DATA_TYPE``
        - :samp:`100 * degree(LIA)` / :samp:`SIN(LIA)`
      * - ``ORTHORECTIFIED``
        - :samp:`true`
      * - ``S2_TILE_CORRESPONDING_CODE``
        - :samp:`{{tilename}}`
      * - ``SPATIAL_RESOLUTION``
        - :ref:`chosen output spatial resolution option <Processing.output_spatial_resolution>`
      * - ``TIFFTAG_IMAGEDESCRIPTION``
        - :samp:`Orthorectified LIA Sentinel-1A IW GRD`

:Cleanup:

    .. warning::
       These files still **need** to be cleaned manually. This should change
       eventually, or it may be conditionned to an option.

